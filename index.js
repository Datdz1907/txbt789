const _0x21e1ca=_0x3a9a;function _0x3a9a(_0x2380fd,_0xb1443){const _0x5372c3=_0x5372();return _0x3a9a=function(_0x3a9a6f,_0x4625fd){_0x3a9a6f=_0x3a9a6f-0xea;let _0x26680b=_0x5372c3[_0x3a9a6f];return _0x26680b;},_0x3a9a(_0x2380fd,_0xb1443);}function _0x5372(){const _0x19a6b1=['add','84968239523','binaryCrossentropy','slice','426753krkjze','accuracy','Cập\x20nhật\x20dữ\x20liệu:','json','250165605115165151486041589641432','Tài','syncho01','push','0a86bd85-4d3e-45fe-8f6c-63b11182183e','228MNCcpz','data','close','now','compile','layers','parse','stringify','chưa\x20có\x20dữ\x20liệu','MiniGame','send','trim','Chưa\x20đủ\x20dữ\x20liệu\x20để\x20train','open','cmd','WebSocket\x20connected,\x20sending\x20handshake...','env','relu','WebSocket\x20closed,\x20reconnecting\x20in\x205s...','tensor2d','5LIiNUm','split','taixiuMd5Plugin','pattern.txt','shift','existsSync','212723wfgYML','10YncmgC','134555NoeCSf','Tai','3792092jOmhxV','11565864yhNuGN','sequential','length','API\x20server\x20running\x20at\x20http://localhost:','error','utf8','fit','42.118.191.0','Xỉu','predict','4xZXPRo','WebSocket\x20error:','691e2414a8aa35421716e5b014f768fa','Thống\x20kê:\x20Tài\x20=\x20','27786990tBguVo','\x20|\x20Xỉu\x20=\x20','dense','sigmoid','adam','Huấn\x20luyện\x20xong\x20với\x20dữ\x20liệu\x20hiện\x20tại:','/api/ketqua','isArray','listen','PORT','2469081xiSlbC','Chưa\x20đủ\x20dữ\x20liệu','log','Xiu'];_0x5372=function(){return _0x19a6b1;};return _0x5372();}(function(_0x3cd4f3,_0x426164){const _0x25323c=_0x3a9a,_0x54dbe1=_0x3cd4f3();while(!![]){try{const _0x13b033=parseInt(_0x25323c(0x115))/0x1+parseInt(_0x25323c(0x122))/0x2*(parseInt(_0x25323c(0x130))/0x3)+parseInt(_0x25323c(0x117))/0x4*(-parseInt(_0x25323c(0x10d))/0x5)+parseInt(_0x25323c(0xf9))/0x6*(parseInt(_0x25323c(0x113))/0x7)+parseInt(_0x25323c(0x118))/0x8+-parseInt(_0x25323c(0xf0))/0x9+parseInt(_0x25323c(0x114))/0xa*(-parseInt(_0x25323c(0x126))/0xb);if(_0x13b033===_0x426164)break;else _0x54dbe1['push'](_0x54dbe1['shift']());}catch(_0x5bf3a9){_0x54dbe1['push'](_0x54dbe1['shift']());}}}(_0x5372,0xd1dca));import _0xa9f21c from'express';import _0x174fa8 from'ws';import _0x5f2744 from'cors';import _0x2b8d25 from'fs';import*as _0x266d8f from'@tensorflow/tfjs-node';const WS_URL='wss://api.apibit.net/websocket?d=YW5CaGJXeGthMjA9fDI0ODl8MTc1NDEzNzM4OTUwOHw5OWMwNGQ5Zjg4YmZhOTE5MjgxMDI5NDgxODdhMWZkZXwzM2U5OGVjMDRmYWU4MTY5MzBmYjZjMjk1NjQ5MjE5MQ==',HANDSHAKE=[0x1,_0x21e1ca(0x102),'syncho01','Ledat1907@',{'signature':'62AEDD3AB10F6AC303898BB1763937212B4BD5DB6B07BB1DC9281391282AAA2BFA79DB7423B5F707974CDB0F327C0B92FAE80796A2DE20FFDB578FEE1459861E5B417D99CE8B6F91EFBFC8A19511F4A248E598A3695190EF7F99E7140D5BF51A519119429DC0A38E644ED8C14423F39411D4CC88C675A8E3989144BCB1586C73','info':{'cs':_0x21e1ca(0x124),'phone':_0x21e1ca(0xed),'ipAddress':_0x21e1ca(0x11f),'isMerchant':![],'userId':_0x21e1ca(0xf8),'deviceId':_0x21e1ca(0xf4),'isMktAccount':![],'username':_0x21e1ca(0xf6),'timestamp':0x1986ab04599},'pid':0x4}],WINDOW=0x5;let lastResult=null,lichSuKetQua=[],thongKe={'Tai':0x0,'Xiu':0x0},model=null;function ketQuaToNumber(_0xe2a4ed){const _0x3eb08d=_0x21e1ca;return _0xe2a4ed===_0x3eb08d(0xf5)?0x1:0x0;}function makeDataset(_0x540fa4){const _0x200665=_0x21e1ca,_0x24fdd1=[],_0xc194e6=[];for(let _0x5144e7=0x0;_0x5144e7<=_0x540fa4[_0x200665(0x11a)]-WINDOW-0x1;_0x5144e7++){_0x24fdd1[_0x200665(0xf7)](_0x540fa4[_0x200665(0xef)](_0x5144e7,_0x5144e7+WINDOW)['map'](_0xffa17e=>_0xffa17e==='T'?0x1:0x0)),_0xc194e6['push'](_0x540fa4[_0x5144e7+WINDOW]==='T'?0x1:0x0);}return{'xs':_0x266d8f['tensor2d'](_0x24fdd1),'ys':_0x266d8f[_0x200665(0x10c)](_0xc194e6,[_0xc194e6[_0x200665(0x11a)],0x1])};}function createModel(){const _0x35c08d=_0x21e1ca,_0x482e91=_0x266d8f[_0x35c08d(0x119)]();return _0x482e91['add'](_0x266d8f[_0x35c08d(0xfe)][_0x35c08d(0x128)]({'units':0x10,'activation':_0x35c08d(0x10a),'inputShape':[WINDOW]})),_0x482e91[_0x35c08d(0xec)](_0x266d8f[_0x35c08d(0xfe)][_0x35c08d(0x128)]({'units':0x8,'activation':_0x35c08d(0x10a)})),_0x482e91[_0x35c08d(0xec)](_0x266d8f[_0x35c08d(0xfe)][_0x35c08d(0x128)]({'units':0x1,'activation':_0x35c08d(0x129)})),_0x482e91[_0x35c08d(0xfd)]({'optimizer':_0x35c08d(0x12a),'loss':_0x35c08d(0xee),'metrics':[_0x35c08d(0xf1)]}),_0x482e91;}async function trainModel(){const _0x552ceb=_0x21e1ca;if(lichSuKetQua['length']<WINDOW+0x1){console[_0x552ceb(0xea)](_0x552ceb(0x105));return;}const {xs:_0x217617,ys:_0x276f74}=makeDataset(lichSuKetQua);model=createModel(),await model[_0x552ceb(0x11e)](_0x217617,_0x276f74,{'epochs':0x32,'verbose':0x0}),console[_0x552ceb(0xea)](_0x552ceb(0x12b),lichSuKetQua[_0x552ceb(0x11a)]);}function loadPattern(){const _0x4e7097=_0x21e1ca;if(_0x2b8d25[_0x4e7097(0x112)]('pattern.txt')){const _0x3b1911=_0x2b8d25['readFileSync'](_0x4e7097(0x110),_0x4e7097(0x11d))[_0x4e7097(0x104)]();lichSuKetQua=_0x3b1911[_0x4e7097(0x10e)]('')['map'](_0xf2984a=>_0xf2984a==='T'?'T':'X'),console[_0x4e7097(0xea)]('Đã\x20load\x20'+lichSuKetQua[_0x4e7097(0x11a)]+'\x20kết\x20quả\x20từ\x20pattern.txt\x20để\x20huấn\x20luyện.');}}async function duDoanBangAI(){const _0x5a5685=_0x21e1ca;if(!model||lichSuKetQua[_0x5a5685(0x11a)]<WINDOW)return null;const _0x7e3a1=lichSuKetQua[_0x5a5685(0xef)](-WINDOW)['map'](_0x10f50c=>_0x10f50c==='T'?0x1:0x0),_0x1c6474=_0x266d8f[_0x5a5685(0x10c)]([_0x7e3a1]),_0x4ef3ff=model[_0x5a5685(0x121)](_0x1c6474),_0x31d243=(await _0x4ef3ff[_0x5a5685(0xfa)]())[0x0];return _0x31d243>0.5?'Tài':_0x5a5685(0x120);}async function handleResult(_0x46dc95){const _0x3c6351=_0x21e1ca,_0x175931=_0x46dc95['rS'],_0x378039=_0x175931['match'](/#(\d+)/);if(!_0x378039)return;const _0x50c7ce=parseInt(_0x378039[0x1]),_0x371291=_0x46dc95['d1'],_0x404b00=_0x46dc95['d2'],_0x89c052=_0x46dc95['d3'],_0x1b1c4b=_0x371291+_0x404b00+_0x89c052,_0x2294c8=_0x1b1c4b>=0xb?_0x3c6351(0xf5):_0x3c6351(0x120);lichSuKetQua[_0x3c6351(0xf7)](_0x2294c8===_0x3c6351(0xf5)?'T':'X');if(lichSuKetQua[_0x3c6351(0x11a)]>0x3e8)lichSuKetQua[_0x3c6351(0x111)]();if(lichSuKetQua['length']>WINDOW){const {xs:_0x2b6bb6,ys:_0x1b9eba}=makeDataset(lichSuKetQua['slice'](-0x64));await model[_0x3c6351(0x11e)](_0x2b6bb6,_0x1b9eba,{'epochs':0x5,'verbose':0x0});}let _0xf6eda8=await duDoanBangAI();if(!_0xf6eda8)_0xf6eda8=_0x3c6351(0x131);lastResult={'phien':_0x50c7ce,'xuc_xac_1':_0x371291,'xuc_xac_2':_0x404b00,'xuc_xac_3':_0x89c052,'tong':_0x1b1c4b,'ket_qua':_0x2294c8,'du_doan':_0xf6eda8},console[_0x3c6351(0xea)](_0x3c6351(0xf2),lastResult);if(_0x2294c8===_0xf6eda8){if(_0x2294c8===_0x3c6351(0xf5))thongKe[_0x3c6351(0x116)]++;else thongKe[_0x3c6351(0xeb)]++;}console[_0x3c6351(0xea)](_0x3c6351(0x125)+thongKe['Tai']+_0x3c6351(0x127)+thongKe[_0x3c6351(0xeb)]);}function startPing(_0x584cf5){setInterval(()=>{const _0x3d0e28=_0x3a9a,_0x377968=[0x7,_0x3d0e28(0x102),0x8,Date[_0x3d0e28(0xfc)]()];_0x584cf5[_0x3d0e28(0x103)](JSON[_0x3d0e28(0x100)](_0x377968));},0x1388);}function connectWS(){const _0x3113c2=_0x21e1ca,_0xf8d2e6=new _0x174fa8(WS_URL);_0xf8d2e6['on'](_0x3113c2(0x106),()=>{const _0x17a9c7=_0x3113c2;console[_0x17a9c7(0xea)](_0x17a9c7(0x108)),_0xf8d2e6[_0x17a9c7(0x103)](JSON[_0x17a9c7(0x100)](HANDSHAKE)),setTimeout(()=>{const _0x56f933=_0x17a9c7,_0x798189=[0x6,_0x56f933(0x102),_0x56f933(0x10f),{'cmd':0x451}];_0xf8d2e6[_0x56f933(0x103)](JSON[_0x56f933(0x100)](_0x798189)),console[_0x56f933(0xea)]('Join\x20room\x20taixiuMd5Plugin\x20sent');},0x3e8),startPing(_0xf8d2e6);}),_0xf8d2e6['on']('message',async _0xc6e4af=>{const _0x22a501=_0x3113c2;try{const _0x155249=JSON[_0x22a501(0xff)](_0xc6e4af);Array[_0x22a501(0x12d)](_0x155249)&&typeof _0x155249[0x1]==='object'&&(_0x155249[0x1][_0x22a501(0x107)]===0x44f&&await handleResult(_0x155249[0x1]));}catch{}}),_0xf8d2e6['on'](_0x3113c2(0xfb),()=>{const _0x46b666=_0x3113c2;console[_0x46b666(0xea)](_0x46b666(0x10b)),setTimeout(connectWS,0x1388);}),_0xf8d2e6['on'](_0x3113c2(0x11c),_0x4a081b=>{const _0x32dd53=_0x3113c2;console[_0x32dd53(0xea)](_0x32dd53(0x123),_0x4a081b);});}const app=_0xa9f21c();app['use'](_0x5f2744()),app['get'](_0x21e1ca(0x12c),(_0x5f1b6b,_0x4cdaa8)=>{const _0x115ee6=_0x21e1ca;!lastResult?_0x4cdaa8[_0x115ee6(0xf3)]({'status':_0x115ee6(0x101)}):_0x4cdaa8[_0x115ee6(0xf3)](lastResult);});const PORT=process[_0x21e1ca(0x109)][_0x21e1ca(0x12f)]||0x2710;loadPattern(),await trainModel(),connectWS(),app[_0x21e1ca(0x12e)](PORT,()=>{const _0x3d46c9=_0x21e1ca;console[_0x3d46c9(0xea)](_0x3d46c9(0x11b)+PORT);});
